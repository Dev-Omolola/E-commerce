<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp" crossorigin="anonymous">
    <title>Document</title>
    <link rel="stylesheet" href="productpage.css">
</head>
<body>
    <main id="screen">
        <div class="anime">
            <img src="https://ng.jumia.is/cms/0-1-weekly-cps/0-2023/w30-Great-Home-App/Nivea-brand-day/JA-brands-top-strip.gif" alt="">
           </div>
          <main class="screen_gangan">
              <div class="upper">
                <div>
                    <a href="">Sell on Jumia</a>
                    <div class="upper_link">
                       <a href="">JUMIA</a>
                       <a href="">PAY</a>
                       <a href="">FOOD</a>
                       <a href="">PARTY</a>
                       <a href="">LOGISTICS</a>
                    </div>
               </div>
              </div>
              <nav>
                 <div class="logo">
                  <img src="data:image/png;base64,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" alt="">
                 </div>
                 <div class="search">
                     <div class="search_input">
                         <span class="material-symbols-outlined">
                            search
                         </span>
                         <input type="text" placeholder="Search products, brands and categories">
                     </div>
                       <button>SEARCH</button>
                  </div>
                 <div class="account">
                  <span class="material-symbols-outlined">
                     account_circle
                  </span>
                  <span>Account</span>
                  <span class="material-symbols-outlined arrow_down">
                      keyboard_arrow_down
                  </span>
                  <span class="material-symbols-outlined arrow-up">
                          keyboard_arrow_up
                  </span>
                  <div class="account_profile">
                      <a href="signin.html">SignIn</a>
                      <a href="signup.html">SignUp</a>
                  </div>
                </div>
              
                 <div class="help">
                     <span class="material-symbols-outlined">
                     help
                     </span>
                     <span>Help</span>
                     <span class="material-symbols-outlined arrow_down">
                      keyboard_arrow_down
                  </span>
                  <span class="material-symbols-outlined arrow-up">
                          keyboard_arrow_up
                  </span>
                  <div class="help_dropdown">
                      <a href="signin.html">Contact us</a>
                      <a href="signup.html">Email Us</a>
                  </div>
               </div>
                 <div id="numCart">
                      <span class="material-symbols-outlined">
                          shopping_cart
                      </span>
                      <span>cart</span>
                      <span id="num">
      
                      </span>
                 </div>
            </nav>
            <div class="container"> 
                <div class="home">
                    <span>Home></span>
                    <span>Top deal</span>
                </div>
                <div class="header">
                     <h4>Top Selling Deals</h4>
                </div>
            </div>
            <div  class="container text-center">
                  <div id="prod_screen" class="m-auto">

                  </div>
            </div>
           
    </main>
</body>
</html>
<script>
    let prod_screen = document.getElementById("prod_screen")
    let allPro;
    let allCategory;
    let topSelling;
    let currUser;
    let userCart

    function numcart(){
     fetch(`http://localhost:1234/carts`, {
                    headers: {
                        "Content-Type": "application/json",
                    },
                
                })
                .then((res)=>res.json())
                .then((cart_data)=>{
                    console.log(cart_data)
                    for (let index = 0; index < cart_data.length; index++) {
                        const element = cart_data[index];
                        document.getElementById("num").innerHTML = `<button onclick="cart()">${cart_data.length}</button>`;
                        console.log(cart_data.length)
                    }
                    
                })  
              
    }
  numcart()

    function fetchProd(){
        fetch("http://localhost:1234/topSelling")
        .then((response)=>response.json())
        .then((data)=>{   
        allPro = data
        console.log(allPro);
        
        for (let index = 0; index < data.length; index++) {
            const element = data[index];
           prod_screen.innerHTML += `<div class="product_div">
                                    <img src="${element.images}" alt="">
                                
                                    <p><span>$</span>${element.price}</p>
                                    <small>${element.title}</small>
                                    <div><button onclick="addToCart(${element.id})">Add to Cart</button></div>
                                </div>`
        }
        })
        
    }
    fetchProd()

    function userscart(){
        fetch("http://localhost:1234/currentusers", {
        headers:{
            "Content-Type":"Application/json",
        },
        
    })
    .then((response)=>response.json())
    .then((data)=>{
        userCart = data;
        console.log(userCart)
    })
      
    }
    userscart()

    function addToCart(productId) {
    // Add to cart
        let found = allPro.find((el)=> el.id == productId)
        console.log(found.InCart);
        if(found.InCart == true){
            alert("Item already in Cart")
        }else{
            found.InCart = true
            fetch("http://localhost:1234/products", {
                headers: {
                    "Content-Type": "application/json"
                },
                method: "POST",
                body: JSON.stringify(found)
            }).then((res)=>{
                console.log(res);
                found.email = userCart[0].email;
                console.log(found)
                fetch(`http://localhost:1234/carts`, {
                    headers: {
                        "Content-Type": "application/json",
                    },
                    method: "POST",
                    body: JSON.stringify(found)
                })
                .then((response) => response.json())
                .then((data) => {
                    alert("Item added to cart")
                    console.log(data);
                    
                //  for (let index = 0; index < data.length; index++) {
                //     const element = data[index];
                //     num.innerHTML = data.length
                //     console.log(num.innerHTML)
                    
                 //  }    
                })
               
           }
      
      

       )}
    }
     
     
  function cart(){
     
     window.location.href = "cart.html"
   }
</script>